<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="csrf-token" content="{{ csrf_token() }}">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FitManager - Rutinas</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/routines.css">

</head>

<body>

    <div class="row" style="margin-top: 20px; margin-bottom: 0;">
        <div class="col s12 container" style="width: 95%; max-width: 1100px;">
            <a href="/training" id="btn-volver" class="btn-flat waves-effect waves-grey fm-btn-back-custom">
                <i class="ph ph-arrow-left"></i>
                <span>Volver a Entrenamiento</span>
            </a>
        </div>
    </div>

    <div class="container" style="margin-top: 10px; width: 95%;">
        <div class="row main-row">

            <div class="col s12 m6">
                <div class="card-panel shadow-none" style="background: #f9f9f9; border: 1px solid #eee;">
                    <h5 class="blue-text"><i class="ph ph-magnifying-glass" aria-hidden="true"></i> Buscador Global</h5>

                    <div class="input-field">
                        <label for="buscador-total" class="active">Buscar ejercicio (ej: Press, Sentadilla...)</label>
                        <input type="text" id="buscador-total" aria-label="Escribe para buscar ejercicios">
                    </div>

                    <div id="resultados-busqueda" class="collection" role="list" aria-live="polite"></div>

                    <hr style="margin: 30px 0; border: 0; border-top: 1px solid #e0e0e0;">

                    <h5 class="green-text"><i class="ph ph-sparkle" aria-hidden="true"></i> Sugerencias para ti</h5>
                    <div id="lista-ejercicios" role="list" aria-label="Ejercicios sugeridos">
                        <div class="fm-loader-container">
                            <div class="fm-dot"></div>
                            <div class="fm-dot"></div>
                            <div class="fm-dot"></div>
                        </div>
                        <p class="loader-text">Cargando rutinas inteligentes</p>
                    </div>
                </div>
            </div>

            <div class="col s12 m6">
                <div class="card-panel"
                    style="position: sticky; top: 20px; border: 2px solid #1a73e8; box-shadow: 0 8px 24px rgba(26, 115, 232, 0.15);">
                    <h5 style="margin-top: 0 !important;"><i class="ph ph-barbell" aria-hidden="true"></i> Mi Rutina
                    </h5>

                    <p class="grey-text" style="margin-top: -5px; margin-bottom: 20px; font-size: 0.9rem;">
                        Tiempo total estimado: <b id="tiempo-total" class="blue-text" style="font-size: 1.1rem;">0</b>
                        min
                    </p>

                    <div class="input-field">
                        <input id="routine_name" type="text" class="validate" style="font-weight: 600;">
                        <label for="routine_name">Nombre de la Rutina (ej: Lunes Pecho)</label>
                    </div>

                    <div id="rutina-personalizada" class="collection" role="list" tabindex="0"
                        aria-label="Lista de ejercicios seleccionados"
                        style="min-height: 250px; background: #fafafa; border: 2px dashed #cfd8dc; border-radius: 12px;">
                        <div class="placeholder-text center-align" style="padding-top: 80px; opacity: 0.6;">
                            <i class="ph ph-hand-grabbing"
                                style="font-size: 30px; display: block; margin-bottom: 10px;"></i>
                            Arrastra aquí tus ejercicios
                        </div>
                    </div>

                    <button class="btn-flat blue-text waves-effect modal-trigger w-100" data-target="modal-ejercicios"
                        aria-label="Abrir ventana para seleccionar ejercicios rápidamente" id="trigger-añadir"
                        style="margin-top: 10px; font-weight: 700;">
                        <i class="ph ph-plus-circle left" aria-hidden="true"></i> Añadir ejercicios (Rápido)
                    </button>

                    <div style="margin-top: 20px;">
                        <button class="btn btn-large waves-effect waves-light w-100 btn-save-custom" id="save-routine"
                            aria-label="Guardar rutina en base de datos">
                            Guardar Rutina <i class="ph ph-floppy-disk right" aria-hidden="true"></i>
                        </button>
                    </div>

                    <div id="mis-rutinas-guardadas"
                        style="margin-top: 40px; padding-top: 20px; border-top: 1px solid #eee;">
                        <h5 style="font-size: 1.1rem !important; color: #555;"><i class="ph ph-folder-star"
                                aria-hidden="true"></i> Guardadas</h5>
                        <div id="lista-rutinas-db" class="collection" role="list" style="border: none;"></div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <div id="modal-ejercicios" class="modal modal-fixed-footer">
        <div class="modal-content">
            <h4 style="font-size: 1.4rem; font-weight: bold;">Añadir Ejercicios</h4>
            <p class="grey-text">Selecciona los que quieras añadir a tu rutina:</p>
            <div id="contenedor-multiselect" role="group" aria-label="Selector múltiple de ejercicios"></div>
        </div>
        <div class="modal-footer">
            <button class="modal-close waves-effect waves-red btn-flat">Cancelar</button>
            <button id="btn-añadir-seleccionados" class="modal-close waves-effect waves-green btn blue">
                Añadir Seleccionados
            </button>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
    <script src="js/apiEjercicios.js"></script>
</body>

</html>